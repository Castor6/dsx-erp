{"timestamp": "2025-09-07T09:44:19.139245", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "241329b9-a2cd-4fe0-b5ae-9c8113d653ee", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 164.56}
{"timestamp": "2025-09-07T09:44:19.202245", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "241329b9-a2cd-4fe0-b5ae-9c8113d653ee", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:19.284245", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "5af1c35a-363d-4ece-930d-90a69c66df7f", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 22.0}
{"timestamp": "2025-09-07T09:44:19.290246", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "5af1c35a-363d-4ece-930d-90a69c66df7f", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:19.318245", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "af894404-0e73-471d-80b7-7237c91a930b", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 20.0}
{"timestamp": "2025-09-07T09:44:19.323245", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "af894404-0e73-471d-80b7-7237c91a930b", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:19.341245", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "12071577-f7e5-49e1-b0e3-372cdab88aa1", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 5.0}
{"timestamp": "2025-09-07T09:44:19.346245", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "12071577-f7e5-49e1-b0e3-372cdab88aa1", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:19.361246", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "8c0a2325-f276-442d-85c9-780c931904b6", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 3.0}
{"timestamp": "2025-09-07T09:44:19.366247", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "8c0a2325-f276-442d-85c9-780c931904b6", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:19.433872", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "099c3e9a-ce72-4a2e-9f07-77f0bb68d273", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 3.0}
{"timestamp": "2025-09-07T09:44:19.438872", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "099c3e9a-ce72-4a2e-9f07-77f0bb68d273", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:23.518107", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "f5a1bcce-fa34-4132-8a00-f9b7e1cf9b3a", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 14.5}
{"timestamp": "2025-09-07T09:44:23.526109", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "f5a1bcce-fa34-4132-8a00-f9b7e1cf9b3a", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:23.559111", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "dae61ab4-38ef-4d4b-8c02-48569e40fc46", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 13.0}
{"timestamp": "2025-09-07T09:44:23.565111", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "dae61ab4-38ef-4d4b-8c02-48569e40fc46", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:23.576615", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "f71dccce-5fee-4c0f-bd9f-3de8aa2e9a71", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 26.51}
{"timestamp": "2025-09-07T09:44:23.582615", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "f71dccce-5fee-4c0f-bd9f-3de8aa2e9a71", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:23.611618", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "70506e0e-ff1d-4cd6-9b4e-0575ff70d2a0", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 11.0}
{"timestamp": "2025-09-07T09:44:23.617618", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "70506e0e-ff1d-4cd6-9b4e-0575ff70d2a0", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:23.627125", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "40185e99-2dc0-401d-aae6-80755da41c73", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 22.51}
{"timestamp": "2025-09-07T09:44:23.634123", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "40185e99-2dc0-401d-aae6-80755da41c73", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:23.651123", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "c68382d3-b2b0-4e67-9dc9-26aabbddc513", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 3.0}
{"timestamp": "2025-09-07T09:44:23.656123", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "c68382d3-b2b0-4e67-9dc9-26aabbddc513", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:23.867788", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "9d280921-5f7b-4599-ab42-f75dac256ac1", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 4.0}
{"timestamp": "2025-09-07T09:44:23.874785", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "9d280921-5f7b-4599-ab42-f75dac256ac1", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:30.098476", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "aa7821f4-077d-4396-988a-9e1eefe23667", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 12.51}
{"timestamp": "2025-09-07T09:44:30.111477", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "aa7821f4-077d-4396-988a-9e1eefe23667", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:30.142451", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "597dcaf6-6d2f-464e-afdc-6b2cec2ad7de", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 13.01}
{"timestamp": "2025-09-07T09:44:30.147956", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "597dcaf6-6d2f-464e-afdc-6b2cec2ad7de", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:30.204509", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "3bede88a-9bce-43a4-828e-b6ec1d9e4258", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 9.51}
{"timestamp": "2025-09-07T09:44:30.211571", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "3bede88a-9bce-43a4-828e-b6ec1d9e4258", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T09:44:30.260571", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?skip=0&limit=5 - AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "e968f677-86c1-4469-af04-eafb8991f40b", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET", "response_time": 3.0}
{"timestamp": "2025-09-07T09:44:30.265571", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: AttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 98, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 93, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 78, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\anyio\\streams\\memory.py\", line 118, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 61, in get_inventory_records\n    func.coalesce(InventoryRecord.total_stock, 0).label(\"total_stock\"),\n                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: type object 'InventoryRecord' has no attribute 'total_stock'", "request_id": "e968f677-86c1-4469-af04-eafb8991f40b", "endpoint": "http://localhost:8000/api/v1/inventory/records?skip=0&limit=5", "method": "GET"}
{"timestamp": "2025-09-07T11:21:19.968174", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "4ae8653e-205b-4991-bd3a-8bfa427a300b", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 17.0}
{"timestamp": "2025-09-07T11:21:20.042538", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "4ae8653e-205b-4991-bd3a-8bfa427a300b", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:21:20.066537", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "b7492410-6d85-4c0c-9cc5-8f7fcd9014ee", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 8.0}
{"timestamp": "2025-09-07T11:21:20.075537", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "336607a2-ddae-4a57-8f28-011b5dfa2e4a", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 15.0}
{"timestamp": "2025-09-07T11:21:20.087538", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "b7492410-6d85-4c0c-9cc5-8f7fcd9014ee", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:21:20.106091", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "336607a2-ddae-4a57-8f28-011b5dfa2e4a", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:21:20.125693", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "1855c903-ad99-48b2-a279-cd923776efa8", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 4.5}
{"timestamp": "2025-09-07T11:21:20.136939", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "1855c903-ad99-48b2-a279-cd923776efa8", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:21:20.264329", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "33a24788-022a-4de3-aa32-bf195d7a97c5", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 6.0}
{"timestamp": "2025-09-07T11:21:20.277329", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "33a24788-022a-4de3-aa32-bf195d7a97c5", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:21:20.434567", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "88f32cbd-8d24-4c4e-a294-5ad41ad156a3", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 5.0}
{"timestamp": "2025-09-07T11:21:20.446565", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "88f32cbd-8d24-4c4e-a294-5ad41ad156a3", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:21:20.465566", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "0612f5be-3196-405c-bf47-4a2644911513", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 4.0}
{"timestamp": "2025-09-07T11:21:20.478566", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "0612f5be-3196-405c-bf47-4a2644911513", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:21:21.181182", "level": "ERROR", "logger": "app.error", "message": "Request failed: GET http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10 - DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "786112bf-004b-42d0-8be5-0dad9a547ed6", "user_id": null, "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET", "response_time": 5.0}
{"timestamp": "2025-09-07T11:21:21.192182", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.InvalidTextRepresentationError: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.Error: <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\inventory.py\", line 89, in get_inventory_records\n    total_result = await db.execute(count_query)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 455, in execute\n    result = await greenlet_spawn(\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2308, in execute\n    return self._execute_internal(\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n             ^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.DBAPIError: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: 对于枚举saletype的输入值无效: \"all\"\n[SQL: SELECT count(*) AS count_1 \nFROM (SELECT inventory_records.id AS id, inventory_records.product_id AS product_id, inventory_records.warehouse_id AS warehouse_id, inventory_records.in_transit AS in_transit, inventory_records.semi_finished AS semi_finished, inventory_records.finished AS finished, inventory_records.shipped AS shipped, inventory_records.created_at AS created_at, inventory_records.updated_at AS updated_at \nFROM inventory_records JOIN products ON products.id = inventory_records.product_id \nWHERE products.sale_type = $1::saletype) AS anon_1]\n[parameters: ('all',)]\n(Background on this error at: https://sqlalche.me/e/20/dbapi)", "request_id": "786112bf-004b-42d0-8be5-0dad9a547ed6", "endpoint": "http://localhost:8000/api/v1/inventory/records?sale_type=all&page=1&size=10", "method": "GET"}
{"timestamp": "2025-09-07T11:57:40.449135", "level": "ERROR", "logger": "app.error", "message": "Request failed: DELETE http://localhost:8000/api/v1/combo-products/3 - IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n[SQL: UPDATE combo_inventory_records SET combo_product_id=$1::INTEGER, updated_at=now() WHERE combo_inventory_records.id = $2::INTEGER]\n[parameters: (None, 3)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "module": "logging_middleware", "function": "dispatch", "line": 87, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.NotNullViolationError: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\combo_products.py\", line 420, in delete_combo_product\n    await db.commit()\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 1011, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 192, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1969, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1256, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1231, in _prepare_impl\n    self.session.flush()\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4312, in flush\n    self._flush(objects)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4447, in _flush\n    with util.safe_reraise():\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4408, in _flush\n    flush_context.execute()\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 85, in save_obj\n    _emit_update_statements(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 909, in _emit_update_statements\n    c = connection.execute(\n        ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n[SQL: UPDATE combo_inventory_records SET combo_product_id=$1::INTEGER, updated_at=now() WHERE combo_inventory_records.id = $2::INTEGER]\n[parameters: (None, 3)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "request_id": "c9cce722-2b87-49b7-9f47-f92825f38bc6", "user_id": null, "endpoint": "http://localhost:8000/api/v1/combo-products/3", "method": "DELETE", "response_time": 16.0}
{"timestamp": "2025-09-07T11:57:40.515658", "level": "ERROR", "logger": "app.error", "message": "Unhandled Exception: IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n[SQL: UPDATE combo_inventory_records SET combo_product_id=$1::INTEGER, updated_at=now() WHERE combo_inventory_records.id = $2::INTEGER]\n[parameters: (None, 3)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "module": "exception_handlers", "function": "general_exception_handler", "line": 46, "exception": "Traceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 267, in __bind_execute\n    data, status, _ = await self.__do_execute(\n                      ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\asyncpg\\prepared_stmt.py\", line 256, in __do_execute\n    return await executor(protocol)\n           ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"asyncpg\\\\protocol\\\\protocol.pyx\", line 206, in bind_execute\nasyncpg.exceptions.NotNullViolationError: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.IntegrityError: <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 91, in __call__\n    await self.simple_response(scope, receive, send, request_headers=headers)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\cors.py\", line 146, in simple_response\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 104, in dispatch\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\middleware\\logging_middleware.py\", line 56, in dispatch\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 84, in call_next\n    raise app_exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 79, in __call__\n    raise exc\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\middleware\\exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\middleware\\asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\starlette\\routing.py\", line 66, in app\n    response = await func(request)\n               ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\fastapi\\routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\app\\api\\api_v1\\endpoints\\combo_products.py\", line 420, in delete_combo_product\n    await db.commit()\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\ext\\asyncio\\session.py\", line 1011, in commit\n    await greenlet_spawn(self.sync_session.commit)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 192, in greenlet_spawn\n    result = context.switch(value)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1969, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1256, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 1231, in _prepare_impl\n    self.session.flush()\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4312, in flush\n    self._flush(objects)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4447, in _flush\n    with util.safe_reraise():\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\session.py\", line 4408, in _flush\n    flush_context.execute()\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 85, in save_obj\n    _emit_update_statements(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\orm\\persistence.py\", line 909, in _emit_update_statements\n    c = connection.execute(\n        ^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1416, in execute\n    return meth(\n           ^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\sql\\elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\engine\\default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\util\\_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n            ^^^^^^^^^^^^\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"G:\\AA_code_space\\dsx_erp\\backend\\.venv\\Lib\\site-packages\\sqlalchemy\\dialects\\postgresql\\asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.IntegrityError: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.NotNullViolationError'>: null value in column \"combo_product_id\" of relation \"combo_inventory_records\" violates not-null constraint\nDETAIL:  失败, 行包含(3, null, 2, 0, 0, 2025-09-06 20:07:02.483378+08, 2025-09-07 11:57:40.436366+08).\n[SQL: UPDATE combo_inventory_records SET combo_product_id=$1::INTEGER, updated_at=now() WHERE combo_inventory_records.id = $2::INTEGER]\n[parameters: (None, 3)]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "request_id": "c9cce722-2b87-49b7-9f47-f92825f38bc6", "endpoint": "http://localhost:8000/api/v1/combo-products/3", "method": "DELETE"}
